<!DOCTYPE html>
<html lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      iOS Metaprogramming with Python, Pt 2 &middot; rockshassa
    
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href="/public/css/poole.css">
  <link rel="stylesheet" href="/public/css/syntax.css">
  <link rel="stylesheet" href="/public/css/hyde.css">
  <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface">

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/apple-touch-icon-144-precomposed.png">
                                 <link rel="shortcut icon" href="/public/favicon.ico">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">
</head>


  <body class="theme-base-0f">

  	<script src="//code.jquery.com/jquery-1.11.3.min.js"></script>
    <script>
    $(document).ready(function(){
    var objArray = ["theme-base-0b","theme-base-0d","theme-base-0c","theme-base-0e","theme-base-0f","theme-base-09","theme-base-08"];
    var $randomClassToShow = objArray[Math.floor(Math.random()*objArray.length)];
      $("body").removeClass();
      $("body").addClass($randomClassToShow);
    });
    </script>

    <div class="sidebar">
  <div class="container sidebar-sticky">
    <div class="sidebar-about">
      <h1>
        <a href="/">
          rockshassa
        </a>
      </h1>
      <p class="lead">such code. wow.</p>
    </div>

    <nav class="sidebar-nav">
      <a class="sidebar-nav-item" href="/">Home</a>

      

      
      
        
          
        
      
        
          
            <a class="sidebar-nav-item" href="/about/">About</a>
          
        
      
        
      
        
          
        
      
        
          
        
      
        
          
        
      

      <!-- <a class="sidebar-nav-item" href="/archive/v2.1.0.zip">Download</a> -->
      <!-- <a class="sidebar-nav-item" href="">GitHub project</a> -->
      <span class="sidebar-nav-item">Currently v2.1.0</span>
    </nav>

    <p>&copy; 2015. All rights reserved.</p>
  </div>
</div>


    <div class="content container">
      <div class="post">
  <h1 class="post-title">iOS Metaprogramming with Python, Pt 2</h1>
  <span class="post-date">06 Jul 2015</span>
  <h2>so offended</h2>

<p>I recently became so mightily offended by the process of adding an App icon to my Xcode project, that I couldn&#39;t bear to move forward without scripting it. I imagine this is the impetus for most automation. </p>

<p>To understand why I wanted to automate this, we should first take a look at the current process and see its pain points.
Consider FooApp, an an iPhone-only iOS application. </p>

<p><img src="/assets/2015-07-06/oldicon.png" alt="such icon"></p>

<h2>brazen disregard for my time</h2>

<p>Xcode wants us to provide 3 different sizes of icons, at 2 different scales, for a total of 6 assets that a designer (or in this case, me) needs to cut. An app that also supported iPad would require even more assets. </p>

<p>In a manual process, I need to:</p>

<ul>
<li>open up my large (1024x1024) source image</li>
<li>resize it appropriately for one of the size/scale combinations</li>
<li>save it with a descriptive name for later identification</li>
</ul>

<p>After repeating the above steps for each of the 6 possibilities, I need to:</p>

<ul>
<li>locate the new images in Finder</li>
<li>drag them into the appropirate slot in Xcode</li>
</ul>

<p>This process is tedious enough that it discourages me from iterating through different icon options. It occurred to me that I could probably come up with a way to automate all of this, so long as I have a large source image and the path to my Xcode project.</p>

<h2>apply python</h2>

<p>First things first, how do we use python to resize an image? A bit of googling led me to <a href="https://python-pillow.github.io/">Pillow</a>, a wrapper/fork for Python Image Library (PIL). It looks like the Image.thumbnail() function from PIL will give us the result we want. After installing it, I wrote a small script to verify it works:</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>

<span class="n">source_img</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s">&#39;path/to/image&#39;</span><span class="p">)</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">size</span> <span class="o">=</span> <span class="p">(</span><span class="mi">120</span><span class="p">,</span><span class="mi">120</span><span class="p">)</span>
    <span class="n">source_img</span><span class="o">.</span><span class="n">thumbnail</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>
    <span class="n">source_img</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s">&#39;new_img&#39;</span><span class="p">,</span> <span class="s">&quot;PNG&quot;</span><span class="p">)</span>
    <span class="n">successStr</span> <span class="o">=</span> <span class="s">&#39;created image for size &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>
    <span class="k">print</span> <span class="n">successStr</span>
<span class="k">except</span> <span class="ne">IOError</span><span class="p">:</span>
    <span class="n">errStr</span> <span class="o">=</span> <span class="s">&#39;cannot create image for size &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>
    <span class="k">print</span> <span class="n">errStr</span>
    <span class="k">return</span></code></pre></div>

<p>Sure enough, this produced a png named &#39;new_img&#39;. I opened it up and verified the correct dimensions (120x120px in this case) and that the image quality had not degraded too drastically. Everything looks good, so the &quot;image&quot; portion of our task is essentially done. </p>

<h2>what is an XCAsset?</h2>

<p>When Xcode deals with the images in your project, it prefers to think of them as XCAssets. From XCode&#39;s perspective, our &quot;App Icon&quot; is a single object, with 6 separate representations. The appropriate representation can be determined at runtime, based on the OS and Device you need to draw the icon for.</p>

<p>XCode stores the metadata for these asset files in a file called Contents.json. The JSON for the doge icon in the screenshot above looks like:</p>

<div class="highlight"><pre><code class="language-json" data-lang="json"><span class="p">{</span>
    <span class="nt">&quot;images&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="nt">&quot;filename&quot;</span><span class="p">:</span> <span class="s2">&quot;doge_60_3x.png&quot;</span><span class="p">,</span>
            <span class="nt">&quot;idiom&quot;</span><span class="p">:</span> <span class="s2">&quot;iphone&quot;</span><span class="p">,</span>
            <span class="nt">&quot;scale&quot;</span><span class="p">:</span> <span class="s2">&quot;3x&quot;</span><span class="p">,</span>
            <span class="nt">&quot;size&quot;</span><span class="p">:</span> <span class="s2">&quot;60x60&quot;</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="nt">&quot;filename&quot;</span><span class="p">:</span> <span class="s2">&quot;doge_60_2x.png&quot;</span><span class="p">,</span>
            <span class="nt">&quot;idiom&quot;</span><span class="p">:</span> <span class="s2">&quot;iphone&quot;</span><span class="p">,</span>
            <span class="nt">&quot;scale&quot;</span><span class="p">:</span> <span class="s2">&quot;2x&quot;</span><span class="p">,</span>
            <span class="nt">&quot;size&quot;</span><span class="p">:</span> <span class="s2">&quot;60x60&quot;</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="nt">&quot;filename&quot;</span><span class="p">:</span> <span class="s2">&quot;doge_40_3x.png&quot;</span><span class="p">,</span>
            <span class="nt">&quot;idiom&quot;</span><span class="p">:</span> <span class="s2">&quot;iphone&quot;</span><span class="p">,</span>
            <span class="nt">&quot;scale&quot;</span><span class="p">:</span> <span class="s2">&quot;3x&quot;</span><span class="p">,</span>
            <span class="nt">&quot;size&quot;</span><span class="p">:</span> <span class="s2">&quot;40x40&quot;</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="nt">&quot;filename&quot;</span><span class="p">:</span> <span class="s2">&quot;doge_40_2x.png&quot;</span><span class="p">,</span>
            <span class="nt">&quot;idiom&quot;</span><span class="p">:</span> <span class="s2">&quot;iphone&quot;</span><span class="p">,</span>
            <span class="nt">&quot;scale&quot;</span><span class="p">:</span> <span class="s2">&quot;2x&quot;</span><span class="p">,</span>
            <span class="nt">&quot;size&quot;</span><span class="p">:</span> <span class="s2">&quot;40x40&quot;</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="nt">&quot;filename&quot;</span><span class="p">:</span> <span class="s2">&quot;doge_29_3x.png&quot;</span><span class="p">,</span>
            <span class="nt">&quot;idiom&quot;</span><span class="p">:</span> <span class="s2">&quot;iphone&quot;</span><span class="p">,</span>
            <span class="nt">&quot;scale&quot;</span><span class="p">:</span> <span class="s2">&quot;3x&quot;</span><span class="p">,</span>
            <span class="nt">&quot;size&quot;</span><span class="p">:</span> <span class="s2">&quot;29x29&quot;</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="nt">&quot;filename&quot;</span><span class="p">:</span> <span class="s2">&quot;doge_29_2x.png&quot;</span><span class="p">,</span>
            <span class="nt">&quot;idiom&quot;</span><span class="p">:</span> <span class="s2">&quot;iphone&quot;</span><span class="p">,</span>
            <span class="nt">&quot;scale&quot;</span><span class="p">:</span> <span class="s2">&quot;2x&quot;</span><span class="p">,</span>
            <span class="nt">&quot;size&quot;</span><span class="p">:</span> <span class="s2">&quot;29x29&quot;</span>
        <span class="p">}</span>
    <span class="p">],</span>
    <span class="nt">&quot;info&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;author&quot;</span><span class="p">:</span> <span class="s2">&quot;xcode&quot;</span><span class="p">,</span>
        <span class="nt">&quot;version&quot;</span><span class="p">:</span> <span class="mi">1</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre></div>

<p>If we&#39;re going to automate the insertion of our images into Xcode and eliminate the &quot;drag and drop&quot; step of the process, we&#39;re going to need to be able to generate a compatible JSON file. A nice object-oriented way of doing this is to create a data model for the &quot;slice&quot; objects in python. Then we just need to give those slices a way to output a JSON representation of themselves. The data model may look like this:</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="k">class</span> <span class="nc">XCAsset</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">size</span><span class="p">,</span><span class="n">scale</span><span class="p">,</span><span class="n">idiom</span><span class="p">,</span><span class="n">filename</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scale</span> <span class="o">=</span> <span class="n">scale</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">idiom</span> <span class="o">=</span> <span class="n">idiom</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="n">filename</span></code></pre></div>

<p>The initializer expects 5 arguments, although we are only going to pass it 4. 
The first argument, &#39;self&#39; is passed implicitly. The remaining ones are size, scale, idiom and filename. These correspond to the properties in the above JSON. </p>

<p>Before we go off and code the to_json() method, it might be helpful to figure out how we want to initialize our Slice objects. A simple way to test our model is to initialize 6 Slices, with the same size/scale/idiom attributes that Xcode expects. We&#39;ll know the filename at runtime because we&#39;ll be creating the images, so we do not need to mimic that property.</p>

<p>Initializing those objects programatically may look like:</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">generate_assets</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
    <span class="n">iphone</span> <span class="o">=</span> <span class="s">&#39;iphone&#39;</span>
    <span class="n">scale2x</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">scale3x</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="n">assets</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">XCAsset</span><span class="p">(</span><span class="mi">60</span><span class="p">,</span><span class="n">scale3x</span><span class="p">,</span><span class="n">iphone</span><span class="p">,</span><span class="n">filename</span><span class="p">),</span>
            <span class="n">XCAsset</span><span class="p">(</span><span class="mi">60</span><span class="p">,</span><span class="n">scale2x</span><span class="p">,</span><span class="n">iphone</span><span class="p">,</span><span class="n">filename</span><span class="p">),</span>

            <span class="n">XCAsset</span><span class="p">(</span><span class="mi">40</span><span class="p">,</span><span class="n">scale3x</span><span class="p">,</span><span class="n">iphone</span><span class="p">,</span><span class="n">filename</span><span class="p">),</span>
            <span class="n">XCAsset</span><span class="p">(</span><span class="mi">40</span><span class="p">,</span><span class="n">scale2x</span><span class="p">,</span><span class="n">iphone</span><span class="p">,</span><span class="n">filename</span><span class="p">),</span>
            
            <span class="n">XCAsset</span><span class="p">(</span><span class="mi">29</span><span class="p">,</span><span class="n">scale3x</span><span class="p">,</span><span class="n">iphone</span><span class="p">,</span><span class="n">filename</span><span class="p">),</span>
            <span class="n">XCAsset</span><span class="p">(</span><span class="mi">29</span><span class="p">,</span><span class="n">scale2x</span><span class="p">,</span><span class="n">iphone</span><span class="p">,</span><span class="n">filename</span><span class="p">)</span>
            <span class="p">]</span>
    <span class="k">return</span> <span class="n">assets</span></code></pre></div>

<!-- 
<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">os</span><span class="o">,</span> <span class="nn">sys</span><span class="o">,</span> <span class="nn">fnmatch</span><span class="o">,</span> <span class="nn">json</span><span class="o">,</span> <span class="nn">shutil</span>
<span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>

<span class="k">class</span> <span class="nc">XCAsset</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">size</span><span class="p">,</span><span class="n">scale</span><span class="p">,</span><span class="n">idiom</span><span class="p">,</span><span class="n">filename</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scale</span> <span class="o">=</span> <span class="n">scale</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">idiom</span> <span class="o">=</span> <span class="n">idiom</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="n">filename</span><span class="o">+</span><span class="s">&#39;_&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">)</span><span class="o">+</span><span class="s">&#39;_&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scale</span><span class="p">)</span><span class="o">+</span><span class="s">&#39;x.png&#39;</span>

    <span class="k">def</span> <span class="nf">to_json</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">jsonDict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">jsonDict</span><span class="p">[</span><span class="s">&#39;size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">)</span><span class="o">+</span><span class="s">&#39;x&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
        <span class="n">jsonDict</span><span class="p">[</span><span class="s">&#39;idiom&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">idiom</span>
        <span class="n">jsonDict</span><span class="p">[</span><span class="s">&#39;filename&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filename</span>
        <span class="n">jsonDict</span><span class="p">[</span><span class="s">&#39;scale&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scale</span><span class="p">)</span><span class="o">+</span><span class="s">&#39;x&#39;</span>
        <span class="c"># print jsonDict</span>
        <span class="k">return</span> <span class="n">jsonDict</span>

<span class="k">def</span> <span class="nf">emptyDir</span><span class="p">(</span><span class="n">directory</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">root</span><span class="p">,</span> <span class="n">dirs</span><span class="p">,</span> <span class="n">files</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">directory</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">unlink</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">f</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">dirs</span><span class="p">:</span>
            <span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">d</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">findFiles</span><span class="p">(</span><span class="n">projectPath</span><span class="p">):</span>
    
    <span class="n">pattern</span> <span class="o">=</span> <span class="s">&#39;AppIcon.appiconset&#39;</span>

    <span class="k">for</span> <span class="n">root</span><span class="p">,</span> <span class="n">dirnames</span><span class="p">,</span> <span class="n">filenames</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">projectPath</span><span class="p">):</span>

        <span class="k">for</span> <span class="n">directory</span> <span class="ow">in</span> <span class="n">dirnames</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">pattern</span> <span class="ow">in</span> <span class="n">directory</span><span class="p">:</span>
                <span class="k">print</span> <span class="s">&#39;found file&#39;</span>
                <span class="n">fullPath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">directory</span><span class="p">)</span>
                <span class="k">print</span> <span class="n">fullPath</span>
                <span class="k">return</span> <span class="n">fullPath</span>

<span class="k">def</span> <span class="nf">makeImage</span><span class="p">(</span><span class="n">source_img</span><span class="p">,</span><span class="n">asset</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">pixels</span> <span class="o">=</span> <span class="n">asset</span><span class="o">.</span><span class="n">size</span><span class="o">*</span><span class="n">asset</span><span class="o">.</span><span class="n">scale</span>
        <span class="n">size</span> <span class="o">=</span> <span class="p">(</span><span class="n">pixels</span><span class="p">,</span><span class="n">pixels</span><span class="p">)</span>
        <span class="n">source_img</span><span class="o">.</span><span class="n">thumbnail</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>
        <span class="n">source_img</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">asset</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="s">&quot;PNG&quot;</span><span class="p">)</span>
        <span class="n">successStr</span> <span class="o">=</span> <span class="s">&#39;created image for size &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>
        <span class="k">print</span> <span class="n">successStr</span>
    <span class="k">except</span> <span class="ne">IOError</span><span class="p">:</span>
        <span class="n">errStr</span> <span class="o">=</span> <span class="s">&#39;cannot create image for size &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>
        <span class="k">print</span> <span class="n">errStr</span>
        <span class="k">return</span>

<span class="k">def</span> <span class="nf">generate_assets</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
    <span class="n">iphone</span> <span class="o">=</span> <span class="s">&#39;iphone&#39;</span>
    <span class="n">scale2x</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">scale3x</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="n">assets</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">XCAsset</span><span class="p">(</span><span class="mi">60</span><span class="p">,</span><span class="n">scale3x</span><span class="p">,</span><span class="n">iphone</span><span class="p">,</span><span class="n">filename</span><span class="p">),</span>
            <span class="n">XCAsset</span><span class="p">(</span><span class="mi">60</span><span class="p">,</span><span class="n">scale2x</span><span class="p">,</span><span class="n">iphone</span><span class="p">,</span><span class="n">filename</span><span class="p">),</span>

            <span class="n">XCAsset</span><span class="p">(</span><span class="mi">40</span><span class="p">,</span><span class="n">scale3x</span><span class="p">,</span><span class="n">iphone</span><span class="p">,</span><span class="n">filename</span><span class="p">),</span>
            <span class="n">XCAsset</span><span class="p">(</span><span class="mi">40</span><span class="p">,</span><span class="n">scale2x</span><span class="p">,</span><span class="n">iphone</span><span class="p">,</span><span class="n">filename</span><span class="p">),</span>
            
            <span class="n">XCAsset</span><span class="p">(</span><span class="mi">29</span><span class="p">,</span><span class="n">scale3x</span><span class="p">,</span><span class="n">iphone</span><span class="p">,</span><span class="n">filename</span><span class="p">),</span>
            <span class="n">XCAsset</span><span class="p">(</span><span class="mi">29</span><span class="p">,</span><span class="n">scale2x</span><span class="p">,</span><span class="n">iphone</span><span class="p">,</span><span class="n">filename</span><span class="p">)</span>
            <span class="p">]</span>
    <span class="k">return</span> <span class="n">assets</span>

<span class="k">def</span> <span class="nf">writeContents</span><span class="p">(</span><span class="n">assets</span><span class="p">):</span>

    <span class="n">jsonDict</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="n">jsonDict</span><span class="p">[</span><span class="s">&#39;info&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                        <span class="s">&#39;version&#39;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                        <span class="s">&#39;author&#39;</span> <span class="p">:</span> <span class="s">&#39;xcode&#39;</span>
                        <span class="p">}</span>

    <span class="n">images</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">assets</span><span class="p">:</span>
        <span class="n">images</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">to_json</span><span class="p">())</span>

    <span class="n">jsonDict</span><span class="p">[</span><span class="s">&#39;images&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">images</span>

    <span class="c">#pretty print</span>
    <span class="k">print</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">jsonDict</span><span class="p">,</span><span class="n">sort_keys</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">separators</span><span class="o">=</span><span class="p">(</span><span class="s">&#39;,&#39;</span><span class="p">,</span> <span class="s">&#39;: &#39;</span><span class="p">))</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">&#39;Contents.json&#39;</span><span class="p">,</span> <span class="s">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">outfile</span><span class="p">:</span>
        <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">jsonDict</span><span class="p">,</span> <span class="n">outfile</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>

    <span class="c">#intended invocation:</span>
    <span class="c">#python make_images.py &lt;imagename (relative to script location)&gt; &lt;project path&gt;</span>
    <span class="c">#python make_images.py FooAppIcon2.png /Users/niko/Documents/FooApp</span>
    <span class="n">argsList</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">argsList</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">:</span>
        <span class="nb">exit</span><span class="p">(</span><span class="s">&#39;not enough args&#39;</span><span class="p">)</span>

    <span class="n">path</span> <span class="o">=</span> <span class="n">argsList</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
    <span class="n">imgName</span> <span class="o">=</span> <span class="n">argsList</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
    <span class="n">fileName</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">imgName</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">source_img</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">imgName</span><span class="p">)</span>

    <span class="n">newDir</span> <span class="o">=</span> <span class="n">findFiles</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
    <span class="n">emptyDir</span><span class="p">(</span><span class="n">newDir</span><span class="p">)</span>
    <span class="n">assets</span> <span class="o">=</span> <span class="n">generate_assets</span><span class="p">(</span><span class="n">fileName</span><span class="p">)</span>
    <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">newDir</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">assets</span><span class="p">:</span>
        <span class="n">img</span> <span class="o">=</span> <span class="n">source_img</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">makeImage</span><span class="p">(</span><span class="n">img</span><span class="p">,</span><span class="n">a</span><span class="p">)</span>

    <span class="n">writeContents</span><span class="p">(</span><span class="n">assets</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span></code></pre></div>
 -->

<p><strong><em>full gist</em></strong></p>

<script src="https://gist.github.com/a56ffdd77145905fe8fb.js"> </script>

</div>

<div class="related">
  <h2>Related Posts</h2>
  <ul class="related-posts">
    
      <li>
        <h3>
          <a href="/2015/06/27/iOS-Metaprogramming/">
            iOS Metaprogramming with Python, Pt 1
            <small>27 Jun 2015</small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/2015/06/26/First-Post/">
            First Post
            <small>26 Jun 2015</small>
          </a>
        </h3>
      </li>
    
  </ul>
</div>

    </div>

  </body>
</html>
